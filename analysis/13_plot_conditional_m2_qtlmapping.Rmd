---
title: "plot_conditional_m2.Novelty_residuals_RankNormal_datarelease_12182019"
author: "Hao He"
date: "`r Sys.Date()`"
output: html_document
---

# plot scan result for conditional_m2.Novelty_residuals_RankNormal_datarelease_12182019
```{r plot scan result for conditional_m2.Novelty_residuals_RankNormal_datarelease_12182019, fig.height=14, fig.width=14, eval=TRUE}
#   This script performs plotting on qtl conditional mapping for DO mice m2, Novelty_residuals_RankNormal_datarelease_12182019
library(qtl2)
library(ggplot2)
load("data/Jackson_Lab_11_batches/gm_DO2816_qc.RData")
pheno <- read.csv("data/pheno/Novelty_residuals_RankNormal_datarelease_12182019.csv", header = TRUE)

print("m2")
load("output/condi.m2.qtl.out.RData")

#genome-wide results
pdf(file = paste0("output/conditional_m2.Novelty_residuals_RankNormal_datarelease_12182019", "_genomescan.pdf"), width = 14)
for(i in names(condi.m2.qtl.out)){
  par(mar=c(5.1, 4.1, 1.1, 1.1))
  ymx <- maxlod(condi.m2.qtl.out[[i]]) # overall maximum LOD score
  plot(condi.m2.qtl.out[[i]], gm_DO2816_qc$gmap, lodcolumn=1,
       col="slateblue", ylim=c(0, ymx*1.02),
       main=i)
}
dev.off()

for(i in names(condi.m2.qtl.out)){
  par(mar=c(5.1, 4.1, 1.1, 1.1))
  ymx <- maxlod(condi.m2.qtl.out[[i]]) # overall maximum LOD score
  plot(condi.m2.qtl.out[[i]], gm_DO2816_qc$gmap, lodcolumn=1,
       col="slateblue", ylim=c(0, ymx*1.02),
       main=i)
}
```
